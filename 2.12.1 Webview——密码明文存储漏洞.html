<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>2.12.1 Webview——密码明文存储漏洞</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="zvp1" id="2121-webview密码明文存储漏洞">2.12.1 Webview——密码明文存储漏洞</h1><div class="md-section-divider"></div><h2 data-anchor-id="51hb" id="问题描述">问题描述</h2><blockquote data-anchor-id="1jv4" class="white-blockquote">
  <p>Webview 默认开启密码保存功能</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="kp8f"><ol class="linenums"><li class="L0"><code><span class="typ">Webview</span><span class="pun">.</span><span class="pln">setSavePassword</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">)</span></code></li></ol></pre><ul data-anchor-id="2rkc">
<li>开启后，在用户输入密码时，会弹出提示框；询问用户是否保存密码；</li>
<li>如果选择是，密码会被明文保存在/data/data/com.xxxx.yyyyy/databases/webview.db中，这样就有盗取密码的风险。</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="5grg" id="风险等级">风险等级</h2><blockquote data-anchor-id="iiqv" class="white-blockquote">
  <p>视情况所定</p>
</blockquote><div class="md-section-divider"></div><h2 data-anchor-id="7i14" id="检测方法">检测方法</h2><ul data-anchor-id="d9qe">
<li>静态分析</li>
<li>在反编译代码中遍历查找SetSavePassword的函数路径，然后在获取函数参数值，判断参数值是否为true。</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="ghwc" id="修复建议">修复建议</h2><p data-anchor-id="q1ha">此api在以后会启用</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="k683"><ol class="linenums"><li class="L0"><code><span class="pln">webSetting</span><span class="pun">.</span><span class="pln">setSavePassword</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="fqr7" id="其他">其他</h2><p data-anchor-id="xjyi"><a href="http://01hackcode.com/wiki/8.4" target="_blank">http://01hackcode.com/wiki/8.4</a></p></div>
</body>
</html>