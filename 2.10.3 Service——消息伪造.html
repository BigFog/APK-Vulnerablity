<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>2.10.3 Service——消息伪造</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="xoma" id="2103-service消息伪造">2.10.3 Service——消息伪造</h1><div class="md-section-divider"></div><h2 data-anchor-id="og9i" id="问题描述">问题描述</h2><blockquote data-anchor-id="m0k7" class="white-blockquote">
  <p>暴露的Service对外接收intent，如果构造恶意的消息放在intent中传输，被调用的service接收就可能产生安全隐患。</p>
</blockquote><div class="md-section-divider"></div><h2 data-anchor-id="oylg" id="风险等级">风险等级</h2><blockquote data-anchor-id="2quo" class="white-blockquote">
  <p>视情况而定</p>
</blockquote><div class="md-section-divider"></div><h2 data-anchor-id="e3ik" id="检测方法">检测方法</h2><ul data-anchor-id="hv86">
<li>查看配置文件中是否有可导出的service组件</li>
<li>在反编译代码中查找putextra等相关方法函数</li>
<li>然后查找有关url，其他信息等</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="cjzv" id="修复建议">修复建议</h2><ul data-anchor-id="eod3">
<li>应用内部使用的service应设置为私有</li>
<li>内部service接收到的数据应该验证并谨慎处理</li>
<li>内部service需要使用签名级别的protectionLevel来判断是否内部调用</li>
<li>不建议在onCreate方法调用时决定是否提供服务，建议在onStartCommand，onBind，onHandleIntent等方法被调用的时候做判断。</li>
<li>使用显示意图只针对有明确服务需求的情况，尽量不发送敏感信息，可信任的service需要对第三方可信公司的app签名做校验</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="tw0u" id="其他">其他</h2><p data-anchor-id="16pd">实例： <br>
<a href="http://www.secevery.com:4321/bugs/wooyun-2015-094635" target="_blank">http://www.secevery.com:4321/bugs/wooyun-2015-094635</a></p></div>
</body>
</html>